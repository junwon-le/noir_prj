<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>공지사항 상세</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-sRIl4kxILfvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<script type="text/javascript">
$(function () {

  $("#btnModify").click(function () {
    if (confirm("공지사항을 정말 수정하시겠습니까?")) {
      // 최소 유효성 (원하면 더 추가 가능)
      if ($("#noticeMsg").val() == null || $("#noticeMsg").val().trim() === "" || $("#noticeMsg").val().trim() === "<p></p>") {
        alert("내용은 필수 입력입니다.");
        return;
      }
      $("#frm")[0].action = "/notice/modifyNoticeProcess";
      $("#frm").submit();
    }
  });

  $("#btnDelete").click(function () {
    if (confirm("공지사항을 정말 삭제하시겠습니까?")) {
      $("#frm")[0].action = "/notice/removeNotice";
      $("#frm").submit();
    }
  });

});
</script>

<!-- summernote (필요하면 유지) -->
<link href="https://cdn.jsdelivr.net/npm/summernote@0.9.0/dist/summernote-lite.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/summernote@0.9.0/dist/summernote-lite.min.js"></script>
<script type="text/javascript">
$(function() {
  $('#noticeMsg').summernote({
    tabsize: 2,
    height: 400,
    toolbar: [
      ['style', ['bold', 'italic', 'underline', 'clear']],
      ['fontsize', ['fontsize']],
      ['color', ['color']],
      ['para', ['ul', 'ol', 'paragraph']],
      ['insert', ['link', 'picture']]
    ]
  });
});
</script>
</head>

<body>
<div class="container" style="max-width: 980px; margin-top: 30px;">

  <h2 class="mb-3">공지사항 상세</h2>

  <!-- ✅ 모델명 notice에 맞춤 -->
  <form method="post" id="frm" th:object="${notice}">
    <table class="table">
      <tr>
        <th style="width:140px;">제목</th>
        <td>
          <input type="text" class="form-control" name="noticeTitle" th:value="*{noticeTitle}">
        </td>
      </tr>

      <tr>
        <th>카테고리</th>
        <td>
          <input type="text" class="form-control" name="noticeCategory" th:value="*{noticeCategory}">
        </td>
      </tr>

      <tr>
        <th>내용</th>
        <td>
          <textarea class="form-control" name="noticeMsg" id="noticeMsg" th:text="*{noticeMsg}"></textarea>
        </td>
      </tr>

      <tr>
        <th>작성일</th>
        <td><span th:text="*{noticeDate}"></span></td>
      </tr>

      <tr>
        <td colspan="2" class="text-center">
          <!-- ✅ 삭제/수정에 필요한 값 -->
          <input type="hidden" name="noticeNum" th:value="*{noticeNum}">
          <!-- ✅ 목록에서 넘어온 currentPage 유지 -->
          <input type="hidden" name="currentPage" th:value="${param.currentPage}">

          <button type="button" class="btn btn-success" id="btnModify">수정</button>
          <button type="button" class="btn btn-danger" id="btnDelete">삭제</button>

          <a class="btn btn-info"
             th:href="@{/notice/searchAllNotice(currentPage=${param.currentPage})}">리스트</a>
        </td>
      </tr>
    </table>
  </form>

</div>
</body>
</html>
