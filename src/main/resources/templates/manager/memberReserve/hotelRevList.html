<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>NOIR호텔 관리자 페이지</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,700,900" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
 	<script src="/common/js/comm/jquery.bxslider.js"></script>
    <link rel="stylesheet" href="/admin_common/css/bootstrap.min.css">
    <link rel="stylesheet" href="/admin_common/css/font-awesome.min.css">
    <link rel="stylesheet" href="/admin_common/css/nalika-icon.css">
    <link rel="stylesheet" href="/admin_common/css/owl.carousel.css">
    <link rel="stylesheet" href="/admin_common/css/owl.theme.css">
    <link rel="stylesheet" href="/admin_common/css/owl.transitions.css">
    <link rel="stylesheet" href="/admin_common/css/animate.css">
    <link rel="stylesheet" href="/admin_common/css/normalize.css">
    <link rel="stylesheet" href="/admin_common/css/meanmenu.min.css">
    <link rel="stylesheet" href="/admin_common/css/main.css">
    <link rel="stylesheet" href="/admin_common/css/morrisjs/morris.css">
    <link rel="stylesheet" href="/admin_common/css/scrollbar/jquery.mCustomScrollbar.min.css">
    <link rel="stylesheet" href="/admin_common/css/metisMenu/metisMenu.min.css">
    <link rel="stylesheet" href="/admin_common/css/metisMenu/metisMenu-vertical.css">
    <link rel="stylesheet" href="/admin_common/css/calendar/fullcalendar.min.css">
    <link rel="stylesheet" href="/admin_common/css/calendar/fullcalendar.print.min.css">
    <link rel="stylesheet" href="/admin_common/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <script src="js/vendor/modernizr-2.8.3.min.js"></script>
    
    
    
    <style>
        /* 테이블 헤더(th) 및 데이터(td) 가운데 정렬 */
        .table thead th, .table tbody td {
            text-align: center !important;
            vertical-align: middle !important;
            border: none !important;
        }

        /* 테이블 행 스타일 */
        .table-row {
            background-color: #ffffff;
            transition: background-color 0.2s;
            border-bottom: 1px solid #f0f2f5 !important;
        }
        .table-row:hover {
            background-color: #f8faff !important;
        }

        /* 뱃지 및 버튼 스타일 */
        .badge-status {
            padding: 6px 14px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: bold;
            color: #fff;
            display: inline-block;
            border: none; /* input 버튼용 테두리 제거 */
            cursor: default;
        }
        
        /* 예약취소 버튼 스타일 (클릭 가능) */
        .btn-cancel {
            cursor: pointer;
            transition: opacity 0.2s;
        }
        .btn-cancel:hover {
            opacity: 0.8;
        }

        .status-refund { background-color: #f19b9b; }
        .status-complete { background-color: #8994bc; }

        .page-btn {
            border: none; background: #344463; color: #fff;
            width: 38px; height: 38px; border-radius: 8px;
            transition: 0.3s; cursor: pointer;
        }
        .page-btn.active { background: #8994bc; }
        
        .form-control.select_style{
            color:black; 
            text-align: center; 
            text-align-last: center; 
            width: 140px; 
            background: #fff; 
            border-radius: 8px; 
            height: 42px; 
            border: 1px solid #e0e6ed; 
            font-weight: 500;
            padding: 0;
        }
        
        /* 모달을 화면 정중앙으로 배치 */
.modal {
    text-align: center;
    padding: 0 !important;
}

.modal:before {
    content: '';
    display: inline-block;
    height: 100%;
    vertical-align: middle;
    margin-right: -4px;
}

.modal-dialog {
    display: inline-block;
    text-align: left;
    vertical-align: middle;
}

tr{
	cursor: pointer;

}
    </style>
    
 <script th:inline="javascript">
 $(function(){
	 
	 $("#searchBtn").click(function(){		 
		 var field=$("#field").val();
		 var keyword=$("#keyword").val().trim();
		 
		 if(field=='N/A'){
			 if(keyword==''){
				 $("#boardSearchFrm").submit();
				 }//end if 
			 }
		 
		 var reg = [new RegExp('^\\d+$'), new RegExp('^[a-zA-Z0-9ㄱ-ㅎ가-힣]+$')];
		 if(field=="reserveNum"){
			if(!keyword.match(reg[0])){
				$("#resultText").text("숫자만 입력해주세요");
				$('#resultModal').modal('show');
				return false;
			}	//end if			 
		 }//end if
		 if(field=="userName"){
			 if(!keyword.match(reg[1])){
					$("#resultText").text("특수문자는 사용 불가능합니다.");
					$('#resultModal').modal('show');
					return false;
				}//end if
		 }//end if
		 
		 if(field=="memberId"){
			 if(!keyword.match(reg[1])){
					$("#resultText").text("특수문자는 사용 불가능합니다.");
					$('#resultModal').modal('show');
					return false;
				}//end if
		 }//end if

		 $("#boardSearchFrm").submit();

	 });//click
	 
	 var flag = /*[[${flag}]]*/ false;
	 if (flag==true) {
		 
		 
	        // 성공 모달 띄우기
	        $('#resultModal').modal('show');
	    }
	
 });
 
 
 function setRevNum(reserveNum){
	  $("#detailRevNum").val(reserveNum);
 }  
 
 
 function cancel(){
			$("#hiddenFrm").prop("action","/admin/hotelMember/cancel");
			$("#hiddenFrm").submit();
 }//cancel
 
 function hotelDetail(reserveNum){
	 if(event.target.tagName !== 'INPUT'){
		 $("#hiddenFrm").prop("action","/admin/hotelMember/hotelDetail")
		 $("#detailRevNum").val(reserveNum);
		 $("#hiddenFrm").submit();

	 }
 }
 </script>
</head>

<body>
     <div th:replace="~{manager/fragments/sidebar :: sidebar}"></div>
    <div class="all-content-wrapper">
        <div class="header-advance-area">
            <div class="breadcome-area">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="breadcome-list" style="margin-left:40px; width:95%; border-radius: 20px;">
                                <div class="row">
                                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                        <div class="breadcomb-wp" style="color:#ffffff; font-size: 20px">
											<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
												  <path d="M2 21H22" stroke="#2C3E50" stroke-width="2" stroke-linecap="round"></path>
												  
												  <path d="M5 21V5C5 3.89543 5.89543 3 7 3H17C18.1046 3 19 3.89543 19 5V21" stroke="#2C3E50" stroke-width="2"></path>
												  
												  <path d="M9 7V11M15 7V11M9 9H15" stroke="#3498DB" stroke-width="1.5" stroke-linecap="round"></path>
												  
												  <path d="M10 21V18C10 16.8954 10.8954 16 12 16C13.1046 16 14 16.8954 14 18V21" stroke="#2C3E50" stroke-width="1.5"></path>
												</svg><span>&nbsp; 호텔 예약 관리(회원)</span>
										</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container" style="min-height:670px; width:100%; color:#ffffff">
            <div class="row" style="padding: 30px; margin-left: 5px;">
                <div class="col-lg-12">
                     <form th:action="@{/admin/hotelMember/}" id="boardSearchFrm" method="get" class="d-flex" style="display: flex; gap: 10px; margin-bottom: 25px; align-items: center;">
                        <select class="form-control select_style" name="field" id="field"> 
                            <option value="N/A" th:selected="${#strings.equals(param.field,'N/A')}">전체</option>
                            <option value="reserveNum" th:selected="${#strings.equals(param.field,'reserveNum')}">예약번호</option>
                            <option value="userName" th:selected="${#strings.equals(param.field,'userName')}">예약자명</option>
                            <option value="memberId" th:selected="${#strings.equals(param.field,'memberId')}">아이디</option>
                        </select> 
                        <div style="position: relative; flex-grow: 1; max-width: 350px;">
                            <button id="searchBtn" style="position: absolute; right: 6px; top: 6px; border: none; background: #8e99bc; color: #fff; border-radius: 6px; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;" onclick="return false;">
                                <i class="fa fa-search"></i>
                            </button>
                            <input type="text" name="keyword" id="keyword" th:value="${param.keyword!=''?param.keyword:''}" class="form-control" placeholder="검색어를 입력하세요" style="background: white; border-radius: 8px; height: 42px; color:black; padding-right: 45px; border: 1px solid #e0e6ed;">
                             <input type="hidden" name="currentPage" id="currentPage" th:value="${param.keyword != null ? 1 : (param.currentPage ?: 1)}"/> 
						
                        </div>
                    </form>

                    <div class="table-responsive" style="background: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                        <table class="table mb-0" style="width: 100%; border-collapse: collapse; ">
                            <thead style="background: #f9fbff; color: #5a6a85;">
                                <tr>
                                    <th style="padding: 18px; border-bottom: 1px solid #ebf1f6; font-weight: 600; width: 90px;">예약번호</th>
                                    <th style="padding: 18px; border-bottom: 1px solid #ebf1f6; font-weight: 600;">예약일</th>
                                    <th style="padding: 18px; border-bottom: 1px solid #ebf1f6; font-weight: 600;">성명</th>
                                    <th style="padding: 18px; border-bottom: 1px solid #ebf1f6; font-weight: 600;">ID</th>
                                    <th style="padding: 18px; border-bottom: 1px solid #ebf1f6; font-weight: 600;">투숙기간</th>
                                    <th style="padding: 18px; border-bottom: 1px solid #ebf1f6; font-weight: 600;">금액</th>
                                    <th style="padding: 18px; border-bottom: 1px solid #ebf1f6; font-weight: 600;">결제일</th>
                                    <th style="padding: 18px; border-bottom: 1px solid #ebf1f6; font-weight: 600; width: 140px;">예약상태</th>
                                </tr>
                            </thead>
                            <tbody style="color: #2a3547; vertical-align: middle; text-align: center;">
                            
                            
                            <th:block th:each="hotelReserveList:${hotelMemberList}" th:object="${hotelReserveList}">
                            
                                <tr class="table-row" th:onclick="hotelDetail([[*{reserveNum}]])">
                                    <td style="padding: 20px; font-family: 'Roboto';" th:text="*{reserveNum}">1</td>
                                    <td style="font-weight: 500;" th:text="*{reserveTime}">박OO</td>
                                    <td style="font-family: 'Roboto'; color: #7c8fac;" th:text="*{reserveName}">2026-01-15 ~ 2026-01-20</td>
                                    <td style="color: #5d87ff;" th:text="*{memberId}">jonajona</td>
                                    <td style="font-family: 'Roboto'; color: #7c8fac;"th:text="|*{startDate} ~ *{endDate}|">2026-01-15 ~ 2026-01-20</td>
                                    <td style="font-family: 'Roboto'; color: #7c8fac;" th:text="|*{#numbers.formatInteger(totalPrice,3,'COMMA')} KRW|">2026-01-15 ~ 2026-01-20</td>
                                    <td style="font-family: 'Roboto'; color: #7c8fac;"th:text="*{inputDate}">2026-01-15 ~ 2026-01-20</td>
                                    <th:block th:if="*{reserveFlag eq 'Y'}">
                                    	<td><span class="badge-status status-refund">환불처리</span></td>
                                	</th:block>
                                	<th:block th:unless="*{reserveFlag eq 'Y'}">
                                		<td><input type="button" value="예약취소" class="badge-status status-complete btn-cancel" data-toggle="modal" data-target="#statusModal" th:onclick="setRevNum([[*{reserveNum}]])"></td>
                                	</th:block>
                                    
                                </tr>
                             </th:block>
                            </tbody>
                        </table>
                    </div>

                    <div style="margin-top: 35px; display: flex; justify-content: center; gap: 8px;">
                     <div th:utext="${pagiNation}" style="display: flex; gap: 8px; align-items: center;"></div>
                      <!--   <button class="page-btn"><i class="fa fa-chevron-left" style="font-size: 12px;"></i></button>
                        <button class="page-btn active">1</button>
                        <button class="page-btn">2</button>
                        <button class="page-btn">3</button>
                        <button class="page-btn">4</button>
                        <button class="page-btn" style="background: transparent; color: #fff;">...</button>
                        <button class="page-btn">10</button>
                        <button class="page-btn">11</button>
                        <button class="page-btn"><i class="fa fa-chevron-right" style="font-size: 12px;"></i></button> -->
                    </div>
                </div>
            </div>
        </div>
        
        <div class="modal fade" id="statusModal" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 350px;">
                <div class="modal-content" style="background: #1b2a47; color: #fff; border-radius: 12px; border: 1px solid #344463;">
                    <div class="modal-body" style="padding: 30px; text-align: center;">
                        <h4 style="margin-bottom: 20px; font-weight: 600;">예약을 취소할까요?</h4>
                        <div style="display: flex; gap: 10px; justify-content: center;">
                            <input type="button" value="아니오" class="btn" data-dismiss="modal" style="background: #344463; color: #fff; width: 100px;">
                    <input type="button" id="revCancelBtn" value="취소하기"  th:onclick="cancel()" class="btn" style="background: #f19b9b; color: #fff; width: 100px; font-weight: bold;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="modal fade" id="resultModal" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 350px;">
                <div class="modal-content" style="background: #1b2a47; color: #fff; border-radius: 12px; border: 1px solid #344463;">
                    <div class="modal-body" style="padding: 30px; text-align: center;">
                        <h4 id="resultText" style="margin-bottom: 20px; font-weight: 600;"th:text="${msg}">예약을 취소할까요?</h4>
                        <div style="display: flex; gap: 10px; justify-content: center;">
                            <input type="button" value="확인" class="btn" data-dismiss="modal" style="background: #344463; color: #fff; width: 100px;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
          <form th:action="@{/admin/hotelMember/hotelDetail}" method="get" id="hiddenFrm">
	        	<input type="hidden" name="currentPage" th:value="${param.currentPage != null && param.currentPage != '' ? param.currentPage : 1}"/>
	        	<input type="hidden" name="field"   th:value="${param.field != null && param.field != '' ? param.field : 'N/A'}"/>
	        	<input type="hidden" name="keyword"  th:value="${param.keyword}"/>
	        	<input type="hidden" name="reserveNum"  id="detailRevNum" />
         
        	</form>

        <div th:replace="~{manager/fragments/footer :: footer}"></div>
    </div>

    <script src="/admin_common/js/vendor/jquery-1.12.4.min.js"></script>
    <script src="/admin_common/js/bootstrap.min.js"></script>
    <script src="/admin_common/js/wow.min.js"></script>
    <script src="/admin_common/js/jquery-price-slider.js"></script>
    <script src="/admin_common/js/jquery.meanmenu.js"></script>
    <script src="/admin_common/js/owl.carousel.min.js"></script>
    <script src="/admin_common/js/jquery.sticky.js"></script>
    <script src="/admin_common/js/jquery.scrollUp.min.js"></script>
    <script src="/admin_common/js/scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="/admin_common/js/scrollbar/mCustomScrollbar-active.js"></script>
    <script src="/admin_common/js/metisMenu/metisMenu.min.js"></script>
    <script src="/admin_common/js/metisMenu/metisMenu-active.js"></script>
    <script src="/admin_common/js/sparkline/jquery.sparkline.min.js"></script>
    <script src="/admin_common/js/sparkline/jquery.charts-sparkline.js"></script>
    <script src="/admin_common/js/calendar/moment.min.js"></script>
    <script src="/admin_common/js/calendar/fullcalendar.min.js"></script>
    <script src="/admin_common/js/calendar/fullcalendar-active.js"></script>
    <script src="/admin_common/js/flot/jquery.flot.js"></script>
    <script src="/admin_common/js/flot/jquery.flot.resize.js"></script>
    <script src="/admin_common/js/flot/curvedLines.js"></script>
    <script src="/admin_common/js/flot/flot-active.js"></script>
    <script src="/admin_common/js/plugins.js"></script>
    <script src="js/main.js"></script>
</body>
</html>